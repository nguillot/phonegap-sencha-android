<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Phonegap-sencha-android : Projet de démo phonegap sencha" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Phonegap-sencha-android</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/nguillot/phonegap-sencha-android">View on GitHub</a>

          <h1 id="project_title">Phonegap-sencha-android</h1>
          <h2 id="project_tagline">Projet de démo phonegap sencha</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/nguillot/phonegap-sencha-android/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/nguillot/phonegap-sencha-android/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>Création des projets</h1>

<p>Créer un répertoire nommé "phonegap-sencha" à l'endroit où vous voulez stocker vos projets.</p>

<h2>Création du projet Android</h2>

<h3>Prérequis</h3>

<ul>
<li>Avoir l'environnement Android installé et à jour</li>
<li>Avoir la dernière version d'intellJ Idea</li>
<li>Avoir télécharger phonegap</li>
</ul><h3>étapes</h3>

<ul>
<li>Créer un projet Android comme suit:</li>
</ul><p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation1.png" alt="Alt création d'un projet android avec IntellJ - 1"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation2.png" alt="Alt création d'un projet android avec IntellJ - 2"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation3.png" alt="Alt création d'un projet android avec IntellJ - 3"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation4.png" alt="Alt création d'un projet android avec IntellJ - 4"></p>

<ul>
<li>
<p>s'ils n'existent pas créer les répertoires</p>

<ul>
<li>/libs</li>
<li>/assets/www</li>
</ul>
</li>
<li><p>copier le fichier cordova-2.1.0.js dans le répertoire /assets/www/</p></li>
<li><p>copier le fichier cordova-2.1.0.jar dans le répertoire /libs</p></li>
<li><p>créer le fichier /assets/www/main.js</p></li>
</ul><pre><code>var isReady = function() {
    document.getElementById("isReady").innerHTML = "is ready";
    document.getElementById("platform").innerHTML = device.platform;
    document.getElementById("version").innerHTML = device.version;
    document.getElementById("name").innerHTML = device.name;
    document.getElementById("width").innerHTML = screen.width;
    document.getElementById("height").innerHTML = screen.height;
};

var getLocation = function() {
    var suc = function(p) {
        alert(p.coords.latitude + " " + p.coords.longitude);
    };
    var locFail = function() {
    };
    navigator.geolocation.getCurrentPosition(suc, locFail);
};

function check_network() {
    var networkState = navigator.network.connection.type;

    var states = {};
    states[Connection.UNKNOWN]  = 'Unknown connection';
    states[Connection.ETHERNET] = 'Ethernet connection';
    states[Connection.WIFI]     = 'WiFi connection';
    states[Connection.CELL_2G]  = 'Cell 2G connection';
    states[Connection.CELL_3G]  = 'Cell 3G connection';
    states[Connection.CELL_4G]  = 'Cell 4G connection';
    states[Connection.NONE]     = 'No network connection';

    confirm('Connection type:\n ' + states[networkState]);
}

function init() {
    // the next line makes it impossible to see Contacts on the HTC Evo since it
    // doesn't have a scroll button
    // document.addEventListener("touchmove", preventBehavior, false);
    document.addEventListener("deviceready", isReady, true);
}
</code></pre>

<ul>
<li>
<p>créer le fichier /assets/www/index.html:</p>

<pre><code>&lt;html&gt;
&lt;head&gt;
  &lt;meta name="viewport" content="width=320; user-scalable=no" /&gt;
  &lt;meta http-equiv="Content-type" content="text/html; charset=utf-8"&gt;
  &lt;title&gt;PhoneGap&lt;/title&gt;
    &lt;link rel="stylesheet" href="master.css" type="text/css" media="screen" title="no title"&gt;
    &lt;script type="text/javascript" charset="utf-8" src="cordova-2.1.0.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" charset="utf-8" src="main.js"&gt;&lt;/script&gt;

&lt;/head&gt;
&lt;body onload="init();" id="stage" class="theme"&gt;
  &lt;h1&gt;Welcome to Cordova!&lt;/h1&gt;
  &lt;h2&gt;this file is located at assets/www/index.html&lt;/h2&gt;
  &lt;div id="info"&gt;
      &lt;h4&gt;Plateform is ready: &lt;span id="isReady"&gt; &amp;nbsp;&lt;/span&gt;&lt;/h4&gt;
      &lt;h4&gt;Platform: &lt;span id="platform"&gt; &amp;nbsp;&lt;/span&gt;,   Version: &lt;span id="version"&gt;&amp;nbsp;&lt;/span&gt;&lt;/h4&gt;
      &lt;h4&gt;Name: &lt;span id="name"&gt;&amp;nbsp;&lt;/span&gt;&lt;/h4&gt;
      &lt;h4&gt;Width: &lt;span id="width"&gt; &amp;nbsp;&lt;/span&gt;,   Height: &lt;span id="height"&gt;&amp;nbsp;&lt;/span&gt;&lt;/h4&gt;
   &lt;/div&gt;
  &lt;a href="#" class="btn large" onclick="getLocation();"&gt;Get Location&lt;/a&gt;
  &lt;a href="#" class="btn large" onclick="check_network();return false;"&gt;Check Network&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
<li><p>créer le fichier res/xml/config.xml:</p></li>
</ul><pre><code>&lt;cordova&gt;
    &lt;access origin="http://127.0.0.1*"/&gt; &lt;!-- allow local pages --&gt;
    &lt;log level="DEBUG"/&gt;
    &lt;preference name="useBrowserHistory" value="false" /&gt;
&lt;plugins&gt;
    &lt;plugin name="App" value="org.apache.cordova.App"/&gt;
    &lt;plugin name="Geolocation" value="org.apache.cordova.GeoBroker"/&gt;
    &lt;plugin name="Device" value="org.apache.cordova.Device"/&gt;
    &lt;plugin name="File" value="org.apache.cordova.FileUtils"/&gt;
    &lt;plugin name="NetworkStatus" value="org.apache.cordova.NetworkManager"/&gt;
    &lt;plugin name="Notification" value="org.apache.cordova.Notification"/&gt;
    &lt;plugin name="Storage" value="org.apache.cordova.Storage"/&gt;
    &lt;plugin name="Temperature" value="org.apache.cordova.TempListener"/&gt;
    &lt;plugin name="FileTransfer" value="org.apache.cordova.FileTransfer"/&gt;
    &lt;plugin name="Battery" value="org.apache.cordova.BatteryListener"/&gt;
    &lt;plugin name="SplashScreen" value="org.apache.cordova.SplashScreen"/&gt;
&lt;/plugins&gt;
&lt;/cordova&gt;
</code></pre>

<p>Il permet de définir les plugins utilisés par phonegap. Si on a besoin de plus de plugins, il faut les ajouter.</p>

<ul>
<li>ajouter ce jar dans le classpath du projet:</li>
</ul><p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation5.png" alt="Alt création d'un projet android avec IntellJ - 5"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation6.png" alt="Alt création d'un projet android avec IntellJ - 6"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation7.png" alt="Alt création d'un projet android avec IntellJ - 7"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation8.png" alt="Alt création d'un projet android avec IntellJ - 8"></p>

<ul>
<li>modifier l'activité de façon à avoir:</li>
</ul><pre><code>package fr.ippon.phonegapsencha;

import android.os.Bundle;
import org.apache.cordova.DroidGap;

public class PhonegapSencha extends DroidGap
{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        super.loadUrl("file:///android_asset/www/index.html");
    }
}
</code></pre>

<ul>
<li>modifier le fichier AndroidManifest.xml de façon à avoir</li>
</ul><pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="fr.ippon.phonegapsencha"
          android:versionCode="1"
          android:versionName="1.0"&gt;
    &lt;uses-sdk android:minSdkVersion="8"/&gt;
    &lt;supports-screens
            android:largeScreens="true"
            android:normalScreens="true"
            android:smallScreens="true"
            android:resizeable="true"
            android:anyDensity="true" /&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" /&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" /&gt;
    &lt;uses-permission android:name="android.permission.READ_PHONE_STATE" /&gt;
    &lt;uses-permission android:name="android.permission.INTERNET" /&gt;
    &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /&gt;
    &lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;
    &lt;uses-permission android:name="android.permission.BROADCAST_STICKY" /&gt;

    &lt;application android:label="@string/app_name"&gt;
        &lt;activity android:name="PhonegapSencha"
                  android:label="@string/app_name"
                  android:configChanges="orientation|keyboardHidden|keyboard|locale"&gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN"/&gt;
                &lt;category android:name="android.intent.category.LAUNCHER"/&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;
&lt;/manifest&gt;
</code></pre>

<ul>
<li>créé</li>
<li>lancer le simulateur, vous devriez obtenir ceci:</li>
</ul><p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/android-project-creation9.png" alt="Alt création d'un projet android avec IntellJ - 9"></p>

<h3>Source</h3>

<p><a href="http://docs.phonegap.com/en/2.1.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android">Phonegap: Getting Started with Android</a></p>

<h2>Partage sous github</h2>

<ul>
<li>
<p>créer le fichier .gitignore à la racine avec le contenu suivant:</p>

<pre><code>
*.iml
*.ipr
*.iws
.idea/
local.properties
bin/
target
gen/
.DS_Store
</code></pre>
</li>
<li><p>ajouter le projet à github:
<img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/partage-git-1.png" alt="Alt partage github avec IntellJ - 1"></p></li>
</ul><p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/partage-git-2.png" alt="Alt partage github avec IntellJ - 2"></p>

<ul>
<li><p>le projet est créé sous giithub mais aucun fichier n'est commité, nous allons arranger ça: dans un terminal lancer la commande à la racine du projet:
''' git add . '''</p></li>
<li><p>remarque ensuite que seul les fichiers n'étant pas dans le gitignore sont ajouté, c'est bien ce que nous voulons:</p></li>
</ul><p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/partage-git-3.png" alt="Alt partage github avec IntellJ - 3"></p>

<ul>
<li>nous allons maintenant commiter ces fichiers dans le repository local:</li>
</ul><p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/partage-git-4.png" alt="Alt partage github avec IntellJ - 4"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/partage-git-5.png" alt="Alt partage github avec IntellJ - 5"></p>

<ul>
<li>il nous reste à pousser ces modifications dans notre github</li>
</ul><p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/partage-git-6.png" alt="Alt partage github avec IntellJ - 6"></p>

<p><img src="https://raw.github.com/nguillot/phonegap-sencha-android/master/images/partage-git-7.png" alt="Alt partage github avec IntellJ - 7"></p>

<p>Le dernier écran liste les commit local, on remarque que j'en ai fait un de plus que vous!</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Phonegap-sencha-android maintained by <a href="https://github.com/nguillot">nguillot</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
